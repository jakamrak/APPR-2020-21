---
title: "Analiza gradbeništva v Sloveniji"
author: "Jaka Mrak"
output:
  html_document: default
  pdf_document:
    includes:
      in_header: lib/styles.sty
    latex_engine: xelatex
runtime: shiny
---

```{r setup, echo=FALSE, results='hide', message=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo=FALSE, message=FALSE, warning=FALSE)

# Uvoz vseh potrebnih knjižnic
source("lib/libraries.r", encoding="UTF-8")
```

```{r rstudio, results='asis'}
# Izris povezave do RStudia na Binderju
source("lib/rstudio.r", encoding="UTF-8")
```

# Izbira teme

Za projektno nalogo sem si izbral tematiko gradbeništva. Osredotočil se bom na obdobje od leta 2010 do danes, saj se je v tem obdobju, po letu 2010/11, v Sloveniji začela kazati gospodarska kriza tudi v gradbenem sektorju in na nepremičninskem trgu, ki se ga v teji nalogi sicer  ne bom dotaknil. Iskal bom povezave med **skupno površino bodočih stanovanj** (na podlagi izdanih gradbenih dovoljenj) ter **številom le-teh**. Kasneje se bom dotaknil tudi kohezije med **cenami arhitekturnega projektiranja** in **vrednostjo opravljenih gradbenih del** v posameznem letu, analiziral bom **gradbene stroške** skozi leta ter za konec primerjal indeks **povprečne neto plače** z deležem naseljenih stanovanj **brez osnovne infrastrukture** po regijah. V nekaterih primerih podatki niso na voljo za vsako leto, vendar le za vsaki dve  oziroma tri, a to ne bo vplivalo na kasnejšo analizo. 

<center>
![](slike/gradb-naslovna.jpg)

***

# Obdelava, uvoz in čiščenje podatkov

```{r uvoz}
source("uvoz/uvoz.r", encoding="UTF-8")
```

Podatke, potrebne za analize sem uvozil iz SURS-a v obliki CSV, xlsx in json. Vse podatke sem prečistil in spremenil v obliko *tidy data* ter tako dobil 7 manjših, urejenih tabel na katerih bom kasneje delal svoje analize.

1. [gradbena.dovoljenja.letno](https://pxweb.stat.si/SiStatData/pxweb/sl/Data/-/1970716S.px/) - podatki o izdanih gradbenih dovoljenjih po statističnih regijah
  - `StatisticnaRegija` - spremenljivka: ime statistične regije (character),
  - `Leto` - spremenljivka: leto meritve (numeric),
  - `SteviloStavb` - meritev: število stavb za katere je bilo v nekem letu izdano gradbeno dovoljenje (numeric),
  - `Povrsina_m2` -meritev: površina stavb za katere je bilo v nekem letu izdano gradbeno dovoljenje (numeric).

2. [gradbena.dovoljenja.sept](https://pxweb.stat.si/SiStatData/pxweb/sl/Data/-/1970712S.px) - podatki o izdanih gradbenih dovoljenjih za mesec september
  - `StatisticnaRegija` - spremenljivka: ime statistične regije (neurejen faktor),
  - `VrstaObjekta` - spremenljivka: pove ali je meritev za stanovanske ali nestanovanjske stavbe (neurejen faktor),
  - `SteviloStavb` - meritev: stevilo stavb za katere je bilo izdano gradbeno dovoljenje (število).
  
  3. [gradbeni.stroski](https://pxweb.stat.si/SiStatData/pxweb/sl/Data/-/1957611S.px/) - letni indeksi gradbenih stroškov
  - `Leto` - spremenljivka: leto meritve (število),
  - `TipStroska` - spremenljivka: pove nam za kateri tip stroška gre (neurejen faktor),
  - `Indeks` - meritev: indeks tega stroška v določenem letu (število).
  
  4. [indeks.cen.arh.proj](https://pxweb.stat.si/SiStatData/pxweb/sl/Data/-/0427601S.px/) - podatki o ceni storitve arhitekturnega projektiranja
  - `Leto` - spremenljivka: leto meritve (število),
  - `PovprecenIndeks` - meritev: povprečen indeks, izračunan iz četrtletnih (število).
  
  5. [indeks.neto.plac](https://pxweb.stat.si/SiStatData/pxweb/sl/Data/-/0772610S.px/) - podatki o neto plačah po statističnih regijah letno
  - `StatisticnaRegija` - spremenljivka: ime statistične regije (neurejen faktor),
  - `Leto` - spremenljivka: leto meritve (število),
  - `Indeks` - meritev: indeks neto plače (število).
  
  6. [stanovanja.brez.os.infra](https://pxweb.stat.si/SiStatData/pxweb/sl/Data/-/0861201S.px/) - podatki o deležih naseljenih stanovanj brez osnovne infrastrukture po statističnih regijah
  - `StatisticnaRegija` - spremenljivka: ime statistične regije (neurejen faktor),
  - `Leto` - spremenljivka:lwto meritve (število),
  - `DelezVOdstotkih` - meritev: delež stanovanj brez osnovne infrastrukture v letu meritve (število).
  
  7. [vrednost.gradb.del](https://pxweb.stat.si/SiStatData/pxweb/sl/Data/-/1919802S.px/)- podatki o vrednosti opravljenih gradbenih del v posameznem letu (v 1000 EUR)
  - `Leto` - spremenljivka: leto meritve (število),
  - `Vrednost_1000EUR` - meritev: vrednost vseh opravljenih gradbenih del v posameznem letu meritve v Sloveniji (število).
  
  
  

#```{r histogram, fig.align='center', fig.cap='Histogram števila naselij v občinah'}
#ggplot(obcine, aes(x=naselja)) + geom_histogram() +
#  ggtitle("Pogostost števila naselij") + xlab("Število naselij") + ylab("Število občin")
#```

***

# Analiza in vizualizacija podatkov

```{r vizualizacija, results='hide'}
#source("vizualizacija/vizualizacija.r", encoding="UTF-8")
```

Spodnji zemljevid prikazuje povprečno velikost družine za vsako občino.

#```{r zemljevid, fig.align='center', fig.cap='Zemljevid povprečnega števila otrok v družini'}
#tm_shape(merge(zemljevid, povprecja, by.x="OB_UIME", by.y="obcina")) +
#  tm_polygons("povprecje", title="Povprečje") +
#  tm_layout(title="Povprečno število otrok v družini")
#```

***

# Napredna analiza podatkov

```{r analiza}
#source("analiza/analiza.r", encoding="UTF-8")
```

Spodnji graf prikazuje povezavo med številom naselij in površino občine.

#```{r graf, fig.align='center', fig.cap='Povezava med številom naselij in površino občine'}
#ggplot(inner_join(obcine, data.frame(obcina=names(skupine),
#                                     skupina=factor(skupine)), by="obcina")
#, aes(x=povrsina, y=naselja, color=skupina, size=prebivalci/1000)) + geom_point() +
#  ggtitle("Število naselij glede na površino občine") +
#  xlab(expression("Površina (km"^2 * ")")) + ylab("Št. naselij") +
#  guides(color=guide_legend(title="Skupina"),
#         size=guide_legend(title="Prebivalci (* 1000)"))
#```

***

#```{r shiny}
#shinyAppDir("shiny", options=list(width="100%", height=600))
#```
